{% extends "base.html" %}

{% block title %}{% endblock %}

{% block content %}

<script>

  var interpretationCount = {{ count }}; // The number of interpretations on this image.
  var pickUsers = [];   // A list
  var current = 0;  // An index for stepping over the list

  var ownerUser = "{{ owner_user }}";
  var currentUser = "{{ user_id }}"; // Start with this one
  var userID = "{{ user_id }}";      // This one won't change

  // Loop over pick_users and populate the users list
  // Question: Can't we just use pick_users directly?
  {% for pick_owner in pick_users %}
    pickUsers.push("{{pick_owner}}");
  {% endfor %}

  var overlay64 = "{{image}}";
  var image_url = "{{ img_obj.url(size=1200) }}";
  var image_key = "{{ img_obj.key().id() }}";
  var baseImageWidth = "{{ img_obj.width }}";
  var baseImageHeight = "{{ img_obj.height }}";
  var pickstyle = "{{ img_obj.pickstyle }}";

</script>

<script src="/static/js/raphael-min.js"></script>
<script src="/static/js/underscore-min.js"></script>
<script src="/static/js/pick-drawing.js"></script>
<script src="/static/js/results.js"></script>


<div class="container">

<div class="row">

  <div class="col-md-4" >

    <p class="lead">Compare your interpretation to the image uploader and everyone else... and vote on those that stand out.</p>

  </div>

  <!-- col for stepping and voting buttons -->
  <div class="col-md-8" style="height:8em; top:1em;">

    <!-- MY PICK - start with this only -->
    <div class="btn-group" role="group" style="margin-left:16px;">
      <button type="button" id="me-button" class="btn btn-success btn-lrg active" style="height:59px;">
        My pick
      </button>
      <button type="button" class="btn btn-success btn-lrg" disabled style="height:59px; width:4em;">
        <span id="my-vote-count" style="font-size:150%; font-weight:bold; line-height:-8px">
        </span><!-- count updated by results.js -->
      </button>
    </div> <!-- end of MY PICK buttons -->

    <!-- OWNER PICK -->
    <!-- disable this button if no owner interpretation 
         or if the current user is the owner -->
    <div class="btn-group" role="group" style="margin-left:16px;">
      <button type="button" id="owner-button" class="btn btn-primary btn-lrg" style="height:59px;" {% if user_id == img_obj.user_id %}disabled{% endif %}>
        Uploader's pick
      </button>
      <div class="btn-group btn-group-vertical" role="group">
      <button type="button" class="btn btn-default btn-sm" title="Upvote" {% if user_id == img_obj.user_id %}disabled{% endif %}><span class="glyphicon glyphicon-thumbs-up grey" id="owner-thumbs-up"></span></button>
      <button type="button" class="btn btn-default btn-sm" title="Downvote" {% if user_id == img_obj.user_id %}disabled{% endif %}><span class="glyphicon glyphicon-thumbs-down grey" id="owner-thumbs-down"></span></button>
      </div>
      <button type="button" class="btn btn-primary btn-lrg" disabled style="height:59px; width:4em;">
        <span id="owner-vote-count" style="font-size:150%; font-weight:bold; line-height:-8px">
        </span><!-- count updated by results.js -->
      </button>
    </div><!-- end of OWNER PICK buttons -->

    <!-- EVERYONE ELSE -->
    <div class="btn-group" role="group" style="margin-left:16px;">
      <button type="button" id="previous-button" class="btn btn-danger btn-lrg" style="height:59px;">
          <span class="glyphicon glyphicon-chevron-left">
      </button>
      <button type="button" id="everyone-button" class="btn btn-danger btn-lrg" style="height:59px;">
        Everyone else
      </button>
      <div class="btn-group btn-group-vertical" role="group">
        <button type="button" id="up-vote-button" class="btn btn-default btn-sm" title="Upvote"><span class="glyphicon glyphicon-thumbs-up grey" id="thumbs-up"></span></button>
        <button type="button" id="down-vote-button" class="btn btn-default btn-sm" title="Downvote"><span class="glyphicon glyphicon-thumbs-down grey" id="thumbs-down"></span></button>
      </div>
      <button type="button" class="btn btn-danger btn-lrg" disabled style="height:59px; width:4em;">
        <span id="vote-count" style="font-size:150%; font-weight:bold; line-height:-8px">
        </span><!-- count updated by results.js -->
      </button>
      <button type="button" id="next-button" class="btn btn-danger btn-lrg" style="height:59px;">
          <span class="glyphicon glyphicon-chevron-right">
      </button>
    </div> <!-- end of EVERYONE ELSE buttons -->



  </div> <!-- end of col -->
  
  </div> <!-- end of row -->


    <div id="image-div"> </div>
    <p class="pull-right" style="font-size:80%">Uploaded by: {{img_obj.nickname}} &mdash; Image owner: {{ img_obj.rightsholder }}</p>
    <p style="font-size:80%">{{ img_obj.width }} &times; {{ img_obj.height }}</p>
    <div class="col-md-offset-2 col-md-8 col-xs-offset-1 col-xs-10" style="top:12px;" id="overlay-slider"></div>

</div><!-- end of container -->

<div style="bottom:24px;"><!-- Just a spacer -->&nbsp;</div>

{% endblock %}
